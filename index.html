<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<body>
  <div id="calculator-body">
    <div id="display"></div>

    <button id="(">(</button>
    <button id=")">)</button>
    <button id="DEL">DEL</button>
    <button id="AC">AC</button>
    <button id="seven" data-numbers="7">7</button>
    
    <button id="eight" data-numbers="8">8</button>
    <button id="nine" data-numbers="9">9</button>
    <button id="divide" data-operator="÷">÷</button>
    <button id="four" data-numbers="4">4</button>
    <button id="five" data-numbers="5">5</button>
    
    <button id="six" data-numbers="6">6</button>
    <button id="multiply" data-operator="x">x</button>
    <button id="one" data-numbers="1">1</button>
    <button id="two" data-numbers="2">2</button>
    <button id="three" data-numbers="3">3</button>
    
    <button id="subtract" data-operator="-">-</button>
    <button id="zero" data-numbers="0">0</button>
    <button id="decimal">.</button>
    <button id="equal" class="operator">=</button>
    <button id="add"  data-operator="+">+</button>
    

  </div>
</body>
<script>
  const calculatorBody = document.getElementById('calculator-body');
  const digits = document.querySelectorAll('button[data-numbers]');
  const operators = document.querySelectorAll('button[data-operator]');
  const display = document.getElementById('display');
  const equal = document.getElementById('equal');
  const decimal = document.getElementById('decimal');
  const del = document.getElementById('DEL');
  const openingParenthesis = document.getElementById('(');
  const closingParenthesis = document.getElementById(')');
  const allClear = document.getElementById('AC');

  let displayValue = '';
  
  // Let's say we store the value, if one of the basic operators has been
  // clicked.
  let currentNumber = '';
  let numberList = []; 
  let currentOperator = '';
  let operatorList = [];

  // Displays the value and operators that has been clicked.
  function populateDisplay() {
    display.innerHTML = displayValue;
  }



  function doBasicOperation(firstNum, secondNum, operator) {
   
    if (operator === '+') {
      return firstNum + secondNum;
    } else if (operator === '-') {
      return firstNum - secondNum;
    } else if (operator === 'x') {
      return firstNum * secondNum;
    } else if (operator === '÷') {
      return firstNum / secondNum;
    } 
  }

  function extractNumbers(array1) {
    return array1.filter(str1 => isNaN(str1) == false) 
  }

  function putNumbersIntoTheList(array1) {
    inputList = extractNumbers(array1);
  }

  function isOperator(operator) {
    if (
      operator === '+'
      || operator === '-'
      || operator === 'x'
      || operator === '÷'
    ) {
      return true;
    } else {
      return false;
    }
  }

  function isMultiplicationOrDivision(operator) {
    return (operator == 'x' || operator == '÷') ? true : false;
  }

  // It takes number List and operator List, and return
  // numbers List calculated regarding to the multiplications and 
  // Divisions, and return operators without any multiplications and
  // Divisions.
  function returnWithoutMultiplicationAndDivision(numbers, operators) {
    let sum = 0;
    let index = 0;
    let operatorsLength = operators.length;

    for (let i = 0; i < operatorsLength; i++) {     
      let currentOperator = operators[index];
      let numOne = numbers[index];
      let numTwo = numbers[index+1];

      if(isMultiplicationOrDivision(operators[index])) {
        let currentResult = 0;// If it's multiplication or Division
        currentResult = doBasicOperation(numOne, numTwo, currentOperator);

        console.log(`${numOne} ${currentOperator} ${numTwo} = ${currentResult}`);

        numbers.splice(index, 2, currentResult);
        operators.splice(index, 1);
      } else {
        index++;  
      }
    }
  return [numbers, operators];
}
  
  // It takes number & operator Lists without multiplications and divisions
  // and return the sum after operating all the operations on the numbers
  // regarding to operators.
  function calculateNumbers(numbers, operators) {
    let sum = 0;

    for (let i = 0; i < operators.length; i++) {     
      let currentOperator = operators[i]

      if (i == 0) { // if it's the first run, do operation and skip
        sum = doBasicOperation(numbers[i], numbers[i+1], currentOperator);
        continue;
      }

      // Otherwise...
      sum = doBasicOperation(sum, numbers[i+1], operators[i]); 
    }

    console.log(`sum in calculatedNumbers function: ${sum}`);
    return sum;
  }

  function operate(numbers, operators) {
    let sum = 0;
    console.log(numbers);
    console.log(operators);
    
    numbers = returnWithoutMultiplicationAndDivision(numbers, operators)[0];
    operators = returnWithoutMultiplicationAndDivision(numbers, operators)[1];
    
    // so...if there's nothing left in the operator...it's done
    if (operators.length == 0) {
      sum = numbers[0];
    } else { // if there's some operators left in the operator
      sum = calculateNumbers(numbers, operators);
    }
    
    display.innerHTML = sum;
  }

  // Event Listeners for all digits
  digits.forEach(digit => {
    digit.addEventListener('click', event => {
      displayValue += event.target.getAttribute("data-numbers");
      populateDisplay();
    })
  })
  
  // Event Listeners for four basic operators
  operators.forEach(operator => {
    operator.addEventListener('click', event => {
      displayValue += event.target.getAttribute("data-operator");
      populateDisplay();
    })
  })

  openingParenthesis.addEventListener('click', event => {
    displayValue += '(';
    populateDisplay();
  })

  closingParenthesis.addEventListener('click', event => {
    displayValue += ')';
    populateDisplay();
  })

  decimal.addEventListener('click', event => {
    displayValue += '.';
    populateDisplay();
  })

  del.addEventListener('click', event => {
    let splittedDisplayValue = displayValue.split('');
    splittedDisplayValue.pop();
    displayValue = splittedDisplayValue.join('');
    populateDisplay();
  })

  allClear.addEventListener('click', event => {
    displayValue = '';
    populateDisplay();
  })

  // If equal is clicked, calculate the all the numbers regarding the operators
  equal.addEventListener('click', event => {
    operate(numberList, operatorList);
    
  })


  

</script>

</html>